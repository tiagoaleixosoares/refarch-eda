<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Using Mirror Maker 2 from Event Streams on OpenShift to local cluster"><meta name=author content="Jerome Boyer"><link href=https://ibm-cloud-architecture.github.com/refarch-eda/use-cases/kafka-mm2/lab-2/ rel=canonical><link rel=icon href=../../../assets/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.17"><title>Mirror Maker 2 ES on RHOS to local cluster - IBM Automation - Event-driven Solution - Sharing knowledge</title><link rel=stylesheet href=../../../assets/stylesheets/main.bcfcd587.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#overview class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="IBM Automation - Event-driven Solution - Sharing knowledge" class="md-header__button md-logo" aria-label="IBM Automation - Event-driven Solution - Sharing knowledge" data-md-component=logo> <img src=../../../images/es-icon.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> IBM Automation - Event-driven Solution - Sharing knowledge </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Mirror Maker 2 ES on RHOS to local cluster </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ibm-cloud-architecture/refarch-eda title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> ibm-cloud-architecture/refarch-eda </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="IBM Automation - Event-driven Solution - Sharing knowledge" class="md-nav__button md-logo" aria-label="IBM Automation - Event-driven Solution - Sharing knowledge" data-md-component=logo> <img src=../../../images/es-icon.png alt=logo> </a> IBM Automation - Event-driven Solution - Sharing knowledge </label> <div class=md-nav__source> <a href=https://github.com/ibm-cloud-architecture/refarch-eda title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> ibm-cloud-architecture/refarch-eda </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../news/ class=md-nav__link> <span class=md-ellipsis> What's new </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Introduction </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Introduction </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../introduction/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../introduction/reference-architecture/ class=md-nav__link> <span class=md-ellipsis> Reference Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../../introduction/usecases/ class=md-nav__link> <span class=md-ellipsis> Business Use Cases </span> </a> </li> <li class=md-nav__item> <a href=../../../introduction/target-audiences/ class=md-nav__link> <span class=md-ellipsis> Target Audiences </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Learning Journey </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Learning Journey </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../journey/101/ class=md-nav__link> <span class=md-ellipsis> Get started (101 content) </span> </a> </li> <li class=md-nav__item> <a href=../../../journey/201/ class=md-nav__link> <span class=md-ellipsis> Deeper dive (201 content) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Concepts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../concepts/terms-and-definitions/ class=md-nav__link> <span class=md-ellipsis> Terms & Definitions </span> </a> </li> <li class=md-nav__item> <a href=../../../concepts/integration/ class=md-nav__link> <span class=md-ellipsis> Agile Integration </span> </a> </li> <li class=md-nav__item> <a href=../../../concepts/events-versus-messages/ class=md-nav__link> <span class=md-ellipsis> Event streaming versus Queuing </span> </a> </li> <li class=md-nav__item> <a href=../../../concepts/fit-to-purpose/ class=md-nav__link> <span class=md-ellipsis> Fit for purpose </span> </a> </li> <li class=md-nav__item> <a href=../../../concepts/model/ class=md-nav__link> <span class=md-ellipsis> Devising the data models </span> </a> </li> <li class=md-nav__item> <a href=../../../concepts/flow-architectures/ class=md-nav__link> <span class=md-ellipsis> Flow Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../../concepts/service-mesh/ class=md-nav__link> <span class=md-ellipsis> Service mesh </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Advantages of EDA </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Advantages of EDA </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../advantages/microservice/ class=md-nav__link> <span class=md-ellipsis> Microservice decoupling </span> </a> </li> <li class=md-nav__item> <a href=../../../advantages/reactive/ class=md-nav__link> <span class=md-ellipsis> Reactive systems </span> </a> </li> <li class=md-nav__item> <a href=../../../advantages/resiliency/ class=md-nav__link> <span class=md-ellipsis> Resiliency </span> </a> </li> <li class=md-nav__item> <a href=../../../advantages/scalability/ class=md-nav__link> <span class=md-ellipsis> Scalability </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Patterns in EDA </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Patterns in EDA </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../patterns/intro/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../../patterns/event-sourcing/ class=md-nav__link> <span class=md-ellipsis> Event Sourcing </span> </a> </li> <li class=md-nav__item> <a href=../../../patterns/cqrs/ class=md-nav__link> <span class=md-ellipsis> CQRS </span> </a> </li> <li class=md-nav__item> <a href=../../../patterns/saga/ class=md-nav__link> <span class=md-ellipsis> Saga </span> </a> </li> <li class=md-nav__item> <a href=../../../patterns/dlq/ class=md-nav__link> <span class=md-ellipsis> Dead Letter Queue </span> </a> </li> <li class=md-nav__item> <a href=../../../patterns/topic-replication/ class=md-nav__link> <span class=md-ellipsis> Topic Replication </span> </a> </li> <li class=md-nav__item> <a href=../../../patterns/data-pipeline/ class=md-nav__link> <span class=md-ellipsis> Data Intensive App </span> </a> </li> <li class=md-nav__item> <a href=../../../patterns/realtime-analytics/ class=md-nav__link> <span class=md-ellipsis> Near real-time analytics </span> </a> </li> <li class=md-nav__item> <a href=../../../patterns/api-mgt/ class=md-nav__link> <span class=md-ellipsis> API management </span> </a> </li> <li class=md-nav__item> <a href=../../../patterns/cep/ class=md-nav__link> <span class=md-ellipsis> Situational decision </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Methodology </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Methodology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../methodology/event-storming/ class=md-nav__link> <span class=md-ellipsis> Event Storming </span> </a> </li> <li class=md-nav__item> <a href=../../../methodology/domain-driven-design/ class=md-nav__link> <span class=md-ellipsis> Domain-Driven Design </span> </a> </li> <li class=md-nav__item> <a href=../../../methodology/data-intensive/ class=md-nav__link> <span class=md-ellipsis> Data Intensive App Development </span> </a> </li> <li class=md-nav__item> <a href=../../../methodology/data-lineage/ class=md-nav__link> <span class=md-ellipsis> Data lineage </span> </a> </li> <li class=md-nav__item> <a href=../../../methodology/governance/ class=md-nav__link> <span class=md-ellipsis> Governance </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Technology </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Technology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../technology/kafka-overview/ class=md-nav__link> <span class=md-ellipsis> Kafka Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/event-streams/ class=md-nav__link> <span class=md-ellipsis> Event Streams </span> </a> </li> <li class=md-nav__item> <a href=https://ibm-cloud-architecture.github.io/eda-tech-academy/demo/ class=md-nav__link> <span class=md-ellipsis> Event Streams Demo Script </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/faq/ class=md-nav__link> <span class=md-ellipsis> Kafka FAQ </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/mq/ class=md-nav__link> <span class=md-ellipsis> MQ in EDA context </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/kafka-producers/ class=md-nav__link> <span class=md-ellipsis> Kafka Producers </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/kafka-consumers/ class=md-nav__link> <span class=md-ellipsis> Kafka Consumers </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/avro-schemas/ class=md-nav__link> <span class=md-ellipsis> Avro Schema </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/advanced-kafka/ class=md-nav__link> <span class=md-ellipsis> Advanced Concepts </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/kafka-streams/ class=md-nav__link> <span class=md-ellipsis> Kafka Streams </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/kafka-connect/ class=md-nav__link> <span class=md-ellipsis> Kafka Connect </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/event-streams/es-maas/security/ class=md-nav__link> <span class=md-ellipsis> Kafka security </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/kafka-monitoring/ class=md-nav__link> <span class=md-ellipsis> Kafka Monitoring </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/kafka-mirrormaker/ class=md-nav__link> <span class=md-ellipsis> Mirror Maker 2 </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/security/ class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/flink/ class=md-nav__link> <span class=md-ellipsis> Apache Flink </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/spring/ class=md-nav__link> <span class=md-ellipsis> Spring cloud </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_10> <label class=md-nav__link for=__nav_10 id=__nav_10_label tabindex=0> <span class=md-ellipsis> Use Cases </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=false> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> Use Cases </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../gitops/ class=md-nav__link> <span class=md-ellipsis> Event-driven solution GitOps </span> </a> </li> <li class=md-nav__item> <a href=../../../technology/event-streams/es-cp4i/ class=md-nav__link> <span class=md-ellipsis> Deploy Event-Streams </span> </a> </li> <li class=md-nav__item> <a href=../../connect-s3/ class=md-nav__link> <span class=md-ellipsis> Kafka Connect - S3 </span> </a> </li> <li class=md-nav__item> <a href=../../connect-cos/ class=md-nav__link> <span class=md-ellipsis> Kafka Connect - COS </span> </a> </li> <li class=md-nav__item> <a href=../../connect-jdbc/ class=md-nav__link> <span class=md-ellipsis> Kafka Connect - jdbc </span> </a> </li> <li class=md-nav__item> <a href=../../connect-mq/ class=md-nav__link> <span class=md-ellipsis> Kafka Connect - MQ </span> </a> </li> <li class=md-nav__item> <a href=../../connect-rabbitmq/ class=md-nav__link> <span class=md-ellipsis> Kafka Connect - Rabbitmq </span> </a> </li> <li class=md-nav__item> <a href=../../kafka-streams/ class=md-nav__link> <span class=md-ellipsis> Kafka Streams labs </span> </a> </li> <li class=md-nav__item> <a href=../../db2-debezium/ class=md-nav__link> <span class=md-ellipsis> DB2 - CDC Debezium - Outbox </span> </a> </li> <li class=md-nav__item> <a href=../ class=md-nav__link> <span class=md-ellipsis> Mirror maker 2 labs </span> </a> </li> <li class=md-nav__item> <a href=../../schema-registry-on-cloud/ class=md-nav__link> <span class=md-ellipsis> Schema registry ES on Cloud </span> </a> </li> <li class=md-nav__item> <a href=../../schema-registry-on-ocp/ class=md-nav__link> <span class=md-ellipsis> Schema registry </span> </a> </li> <li class=md-nav__item> <a href=../../monitoring-on-cloud/ class=md-nav__link> <span class=md-ellipsis> Monitoring ES on Cloud </span> </a> </li> <li class=md-nav__item> <a href=../../monitoring-on-ocp/ class=md-nav__link> <span class=md-ellipsis> Monitoring ES </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_11> <label class=md-nav__link for=__nav_11 id=__nav_11_label tabindex=0> <span class=md-ellipsis> Scenarios </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_11_label aria-expanded=false> <label class=md-nav__title for=__nav_11> <span class="md-nav__icon md-icon"></span> Scenarios </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../scenarios/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=https://ibm-cloud-architecture.github.io/refarch-kc/ class=md-nav__link> <span class=md-ellipsis> Reefer Shipment Solution </span> </a> </li> <li class=md-nav__item> <a href=https://ibm-cloud-architecture.github.io/vaccine-solution-main/ class=md-nav__link> <span class=md-ellipsis> Vaccine at Scale </span> </a> </li> <li class=md-nav__item> <a href=https://ibm-cloud-architecture.github.io/eda-rt-inventory-gitops class=md-nav__link> <span class=md-ellipsis> Near real-time Inventory </span> </a> </li> <li class=md-nav__item> <a href=../../../scenarios/saga-orchestration/ class=md-nav__link> <span class=md-ellipsis> SAGA with MQ Orchestration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../additional-reading/ class=md-nav__link> <span class=md-ellipsis> Additional reading </span> </a> </li> <li class=md-nav__item> <a href=../../../contribute/ class=md-nav__link> <span class=md-ellipsis> Contribute to this Site </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#scenario-prerequisites class=md-nav__link> <span class=md-ellipsis> Scenario Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=#start-strimzi-kafka-cluster class=md-nav__link> <span class=md-ellipsis> Start Strimzi Kafka Cluster </span> </a> </li> <li class=md-nav__item> <a href=#produce-messages-to-source-cluster class=md-nav__link> <span class=md-ellipsis> Produce messages to source cluster </span> </a> </li> <li class=md-nav__item> <a href=#start-mirror-maker-2 class=md-nav__link> <span class=md-ellipsis> Start Mirror Maker 2 </span> </a> </li> <li class=md-nav__item> <a href=#start-consumer-from-target-cluster class=md-nav__link> <span class=md-ellipsis> Start consumer from target cluster </span> </a> </li> <li class=md-nav__item> <a href=#clean-up class=md-nav__link> <span class=md-ellipsis> Clean up </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Mirror Maker 2 ES on RHOS to local cluster</h1> <p><anchorlinks> <anchorlink>Scenario Prerequisites</anchorlink> <anchorlink>Overview</anchorlink> <anchorlink>Start Strimzi Kafka Cluster</anchorlink> <anchorlink>Produce messages to source cluster</anchorlink> <anchorlink>Start Mirror Maker 2</anchorlink> <anchorlink>Start Consumer from target cluster</anchorlink> <anchorlink>Clean up</anchorlink> </anchorlinks></p> <p>Updated 01/22/2021</p> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>For this scenario, the source cluster will be an IBM Event Streams instance on OpenShift and the target cluster will be another Kafka cluster (using <a href=https://strimzi.io/ >Strimzi</a>) running locally on your workstation. Mirror Maker 2 will also run locally on your workstation. This lab is similar to the previous <a href=/use-cases/kafka-mm2/lab-1/ >Lab 1</a>, but instead it uses IBM Event Streams within the Cloud Pak for Integration as illustrated in the figure below:</p> <p><img alt=1 src=../images/mm2-lab2.png></p> <ol> <li>Mirror Maker 2 runs locally on your workstation.</li> <li>A producer to send records to the <code>products</code> topic that also runs locally although it could be deployed on OpenShift as a <strong>job</strong> as well.</li> <li>A Kafka cluster running locally on your workstation that will contain the replicated topic and a Kafka console consumer to see the replicated messages.</li> </ol> <h2 id=scenario-prerequisites>Scenario Prerequisites<a class=headerlink href=#scenario-prerequisites title="Permanent link">&para;</a></h2> <ul> <li>An IBM Event Streams instance running on OpenShift. See <a href=https://ibm.github.io/event-streams/installing/installing/ >here</a> for more detail about installing IBM Event Streams.</li> <li>Docker Compose</li> <li>Git CLI</li> </ul> <p>Complete the following steps in order to get ready for executing this lab scenario</p> <ol> <li> <p>Create the <code>products</code> topic in your IBM Event Streams instance running on OpenShift. <strong>IMPORTANT:</strong> Create the topic with just <strong>1 partition</strong>. To do so, please review the instructions in the Common pre-requisites of this website <a href=/use-cases/overview/pre-requisites#create-event-streams-topics>here</a>. <strong>IMPORTANT:</strong> If you are sharing the IBM Event Streams instance, append a unique identifier to the <code>products</code> topic name so that you don't collide with anyone else.</p> </li> <li> <p>If you did not complete <a href=/use-cases/kafka-mm2/lab-1/ >Lab 1</a>, clone the following GitHub repository to your local workstation to get the Mirror Maker 2 configuration files for this lab:</p> </li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>git<span class=w> </span>clone<span class=w> </span>https://github.com/ibm-cloud-architecture/refarch-eda-tools
</code></pre></div> <ol> <li>Change directory into <code>refarch-eda-tools/labs/mirror-maker2/es-cp4i-to-local</code></li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=nb>cd</span><span class=w> </span>refarch-eda-tools/labs/mirror-maker2/es-cp4i-to-local
</code></pre></div> <ol> <li>Rename the <code>.env-tmpl</code> properties file to <code>.env</code></li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>mv<span class=w> </span>.env-tmpl<span class=w> </span>.env
</code></pre></div> <ol> <li> <p>Download the IBM Event Streams TLS certificate so that your Kafka Connect framework local instance can establish secure communication with your IBM Event Streams instance. <strong>IMPORTANT:</strong> download the PKCS12 certificate. How to get the certificate in the <a href=/use-cases/overview/pre-requisites/ >Common pre-requisites</a> section. </p> </li> <li> <p>The <code>.env</code> properties file will contain the properties needed for Mirror Maker 2 to be able to connect with your IBM Event Streams instance running on Openshift. Therefore, replace the following placeholder in the properties file:</p> <ul> <li><code>REPLACE_WITH_YOUR_BOOTSTRAP_URL</code>: Your IBM Event Streams bootstrap url.</li> <li><code>REPLACE_WITH_YOUR_PKCS12_CERTIFICATE_PASSWORD</code>: Your PCKS12 TLS certificate password.</li> <li><code>REPLACE_WITH_YOUR_SCRAM_USERNAME</code>: Your SCRAM service credentials username.</li> <li><code>REPLACE_WITH_YOUR_SCRAM_PASSWORD</code>: Your SCRAM service credentials password.</li> <li><code>REPLACE_WITH_YOUR_TOPIC</code>: Name of the topic you created above.</li> </ul> </li> </ol> <p>Review the <a href=/use-cases/overview/pre-requisites/ >Common pre-requisites</a> instructions if you don't know how to find out any of the config properties above. </p> <h2 id=start-strimzi-kafka-cluster>Start Strimzi Kafka Cluster<a class=headerlink href=#start-strimzi-kafka-cluster title="Permanent link">&para;</a></h2> <p>In this section, we are going to deploy and start a local <a href=https://strimzi.io/ >Strimzi Kafka cluster</a> which will act as your target cluster for Mirror Maker 2 to mirror the messages getting into the <code>products</code> topic in your IBM Event Streams instance to. In order to deploy this local Strimzi Kafka cluster, we are providing a <a href=https://docs.docker.com/compose/ >Docker Compose</a> file that will coordinate the startup of all the components in this Strimzi Kafka cluster.</p> <ol> <li> <p>Make sure you are in <code>refarch-eda-tools/labs/mirror-maker2/es-cp4i-to-local</code>.</p> </li> <li> <p>Execute the following command</p> </li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>docker-compose<span class=w> </span>up<span class=w> </span>-d
</code></pre></div> <ol> <li>The above command should start all the components in <code>detached</code> mode (<code>-d</code>) and you should see the following output:</li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>Creating<span class=w> </span>zookeeper1<span class=w> </span>...<span class=w> </span><span class=k>done</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>Creating<span class=w> </span>kafka1<span class=w>     </span>...<span class=w> </span><span class=k>done</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>Creating<span class=w> </span>kafka2<span class=w>     </span>...<span class=w> </span><span class=k>done</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>Creating<span class=w> </span>kafka3<span class=w>     </span>...<span class=w> </span><span class=k>done</span>
</code></pre></div> <ol> <li>You should see the following Docker containers running on your workstation at the moment</li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>docker<span class=w> </span>ps
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>CONTAINER<span class=w> </span>ID<span class=w>   </span>IMAGE<span class=w>                              </span>COMMAND<span class=w>                  </span>CREATED<span class=w>         </span>STATUS<span class=w>         </span>PORTS<span class=w>                                              </span>NAMES
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>1981f1913ab6<span class=w>   </span>strimzi/kafka:latest-kafka-2.6.0<span class=w>   </span><span class=s2>&quot;sh -c &#39;bin/kafka-se…&quot;</span><span class=w>   </span><span class=m>2</span><span class=w> </span>minutes<span class=w> </span>ago<span class=w>   </span>Up<span class=w> </span><span class=m>2</span><span class=w> </span>minutes<span class=w>   </span><span class=m>0</span>.0.0.0:9093-&gt;9093/tcp,<span class=w> </span><span class=m>0</span>.0.0.0:29093-&gt;29093/tcp<span class=w>   </span>kafka3
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>5f8fd3e80406<span class=w>   </span>strimzi/kafka:latest-kafka-2.6.0<span class=w>   </span><span class=s2>&quot;sh -c &#39;bin/kafka-se…&quot;</span><span class=w>   </span><span class=m>2</span><span class=w> </span>minutes<span class=w> </span>ago<span class=w>   </span>Up<span class=w> </span><span class=m>2</span><span class=w> </span>minutes<span class=w>   </span><span class=m>0</span>.0.0.0:9091-&gt;9091/tcp,<span class=w> </span><span class=m>0</span>.0.0.0:29091-&gt;29091/tcp<span class=w>   </span>kafka1
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>b19a05bd74dd<span class=w>   </span>strimzi/kafka:latest-kafka-2.6.0<span class=w>   </span><span class=s2>&quot;sh -c &#39;bin/kafka-se…&quot;</span><span class=w>   </span><span class=m>2</span><span class=w> </span>minutes<span class=w> </span>ago<span class=w>   </span>Up<span class=w> </span><span class=m>2</span><span class=w> </span>minutes<span class=w>   </span><span class=m>0</span>.0.0.0:9092-&gt;9092/tcp,<span class=w> </span><span class=m>0</span>.0.0.0:29092-&gt;29092/tcp<span class=w>   </span>kafka2
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>93f500c8517a<span class=w>   </span>strimzi/kafka:latest-kafka-2.6.0<span class=w>   </span><span class=s2>&quot;sh -c &#39;bin/zookeepe…&quot;</span><span class=w>   </span><span class=m>2</span><span class=w> </span>minutes<span class=w> </span>ago<span class=w>   </span>Up<span class=w> </span><span class=m>2</span><span class=w> </span>minutes<span class=w>   </span><span class=m>0</span>.0.0.0:2181-&gt;2181/tcp<span class=w>                             </span>zookeeper1
</code></pre></div> <h2 id=produce-messages-to-source-cluster>Produce messages to source cluster<a class=headerlink href=#produce-messages-to-source-cluster title="Permanent link">&para;</a></h2> <p>In this section, we are going to finally send events to the <code>products</code> topic in your IBM Event streams instance, which is your source cluster, and then verify those messages get mirrored by Mirror Maker 2 into your local Strimzi Kafka cluster, which is your target cluster. We are going to use a shell script which, in turn, will run a Python application that will send the messages to the source cluster.</p> <ol> <li> <p>Since the application sending the messages to the source cluster is not a Java application, we will first need to download the <code>PEM</code> TLS certificate to allow the secure connection from the python application sending the messages to IBM Event Streams. Make sure you are in the <code>refarch-eda-tools/labs/mirror-maker2/es-cp4i-to-local</code> directory. Download the <code>PEM</code> TLS certificate there. Review the <a href=/use-cases/overview/pre-requisites/ >Common pre-requisites</a> instructions if you don't remember how to download the certificate.</p> </li> <li> <p>Now we are going to send five records. In a new terminal window, make sure you are in the <code>refarch-eda-tools/labs/mirror-maker2/es-cp4i-to-local</code> directory and execute the following bash script.</p> </li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>./sendProductRecords.sh
</code></pre></div> <ol> <li>You should see the following output indicating your messages have been delivered to the source cluster topic</li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>---<span class=w> </span>This<span class=w> </span>is<span class=w> </span>the<span class=w> </span>configuration<span class=w> </span><span class=k>for</span><span class=w> </span>the<span class=w> </span>producer:<span class=w> </span>---
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=o>[</span>KafkaProducer<span class=o>]</span><span class=w> </span>-<span class=w> </span><span class=o>{</span><span class=s1>&#39;bootstrap.servers&#39;</span>:<span class=w> </span><span class=s1>&#39;kafka-bootstrap-integration.apps.net:443&#39;</span>,<span class=w> </span><span class=s1>&#39;group.id&#39;</span>:<span class=w> </span><span class=s1>&#39;ProductsProducer&#39;</span>,<span class=w> </span><span class=s1>&#39;delivery.timeout.ms&#39;</span>:<span class=w> </span><span class=m>15000</span>,<span class=w> </span><span class=s1>&#39;request.timeout.ms&#39;</span>:<span class=w> </span><span class=m>15000</span>,<span class=w> </span><span class=s1>&#39;security.protocol&#39;</span>:<span class=w> </span><span class=s1>&#39;SASL_SSL&#39;</span>,<span class=w> </span><span class=s1>&#39;sasl.mechanisms&#39;</span>:<span class=w> </span><span class=s1>&#39;SCRAM-SHA-512&#39;</span>,<span class=w> </span><span class=s1>&#39;sasl.username&#39;</span>:<span class=w> </span><span class=s1>&#39;test_user&#39;</span>,<span class=w> </span><span class=s1>&#39;sasl.password&#39;</span>:<span class=w> </span><span class=s1>&#39;******&#39;</span>,<span class=w> </span><span class=s1>&#39;ssl.ca.location&#39;</span>:<span class=w> </span><span class=s1>&#39;/home/es-cp4i-to-local/es-cert.pem&#39;</span><span class=o>}</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>---------------------------------------------------
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=o>{</span><span class=s1>&#39;product_id&#39;</span>:<span class=w> </span><span class=s1>&#39;P01&#39;</span>,<span class=w> </span><span class=s1>&#39;description&#39;</span>:<span class=w> </span><span class=s1>&#39;Carrots&#39;</span>,<span class=w> </span><span class=s1>&#39;target_temperature&#39;</span>:<span class=w> </span><span class=m>4</span>,<span class=w> </span><span class=s1>&#39;target_humidity_level&#39;</span>:<span class=w> </span><span class=m>0</span>.4,<span class=w> </span><span class=s1>&#39;content_type&#39;</span>:<span class=w> </span><span class=m>1</span><span class=o>}</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=o>{</span><span class=s1>&#39;product_id&#39;</span>:<span class=w> </span><span class=s1>&#39;P02&#39;</span>,<span class=w> </span><span class=s1>&#39;description&#39;</span>:<span class=w> </span><span class=s1>&#39;Banana&#39;</span>,<span class=w> </span><span class=s1>&#39;target_temperature&#39;</span>:<span class=w> </span><span class=m>6</span>,<span class=w> </span><span class=s1>&#39;target_humidity_level&#39;</span>:<span class=w> </span><span class=m>0</span>.6,<span class=w> </span><span class=s1>&#39;content_type&#39;</span>:<span class=w> </span><span class=m>2</span><span class=o>}</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=o>{</span><span class=s1>&#39;product_id&#39;</span>:<span class=w> </span><span class=s1>&#39;P03&#39;</span>,<span class=w> </span><span class=s1>&#39;description&#39;</span>:<span class=w> </span><span class=s1>&#39;Salad&#39;</span>,<span class=w> </span><span class=s1>&#39;target_temperature&#39;</span>:<span class=w> </span><span class=m>4</span>,<span class=w> </span><span class=s1>&#39;target_humidity_level&#39;</span>:<span class=w> </span><span class=m>0</span>.4,<span class=w> </span><span class=s1>&#39;content_type&#39;</span>:<span class=w> </span><span class=m>1</span><span class=o>}</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=o>{</span><span class=s1>&#39;product_id&#39;</span>:<span class=w> </span><span class=s1>&#39;P04&#39;</span>,<span class=w> </span><span class=s1>&#39;description&#39;</span>:<span class=w> </span><span class=s1>&#39;Avocado&#39;</span>,<span class=w> </span><span class=s1>&#39;target_temperature&#39;</span>:<span class=w> </span><span class=m>6</span>,<span class=w> </span><span class=s1>&#39;target_humidity_level&#39;</span>:<span class=w> </span><span class=m>0</span>.4,<span class=w> </span><span class=s1>&#39;content_type&#39;</span>:<span class=w> </span><span class=m>1</span><span class=o>}</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=o>{</span><span class=s1>&#39;product_id&#39;</span>:<span class=w> </span><span class=s1>&#39;P05&#39;</span>,<span class=w> </span><span class=s1>&#39;description&#39;</span>:<span class=w> </span><span class=s1>&#39;Tomato&#39;</span>,<span class=w> </span><span class=s1>&#39;target_temperature&#39;</span>:<span class=w> </span><span class=m>4</span>,<span class=w> </span><span class=s1>&#39;target_humidity_level&#39;</span>:<span class=w> </span><span class=m>0</span>.4,<span class=w> </span><span class=s1>&#39;content_type&#39;</span>:<span class=w> </span><span class=m>2</span><span class=o>}</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=o>[</span>KafkaProducer<span class=o>]</span><span class=w> </span>-<span class=w> </span>Message<span class=w> </span>delivered<span class=w> </span>to<span class=w> </span>products<span class=w> </span><span class=o>[</span><span class=m>0</span><span class=o>]</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=o>[</span>KafkaProducer<span class=o>]</span><span class=w> </span>-<span class=w> </span>Message<span class=w> </span>delivered<span class=w> </span>to<span class=w> </span>products<span class=w> </span><span class=o>[</span><span class=m>0</span><span class=o>]</span>
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=o>[</span>KafkaProducer<span class=o>]</span><span class=w> </span>-<span class=w> </span>Message<span class=w> </span>delivered<span class=w> </span>to<span class=w> </span>products<span class=w> </span><span class=o>[</span><span class=m>0</span><span class=o>]</span>
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=o>[</span>KafkaProducer<span class=o>]</span><span class=w> </span>-<span class=w> </span>Message<span class=w> </span>delivered<span class=w> </span>to<span class=w> </span>products<span class=w> </span><span class=o>[</span><span class=m>0</span><span class=o>]</span>
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=o>[</span>KafkaProducer<span class=o>]</span><span class=w> </span>-<span class=w> </span>Message<span class=w> </span>delivered<span class=w> </span>to<span class=w> </span>products<span class=w> </span><span class=o>[</span><span class=m>0</span><span class=o>]</span>
</code></pre></div> <ol> <li>If you go to the IBM Event Streams console, you should also see those messages in the topic</li> </ol> <p><img alt src=../images/es-products-topic.png></p> <h2 id=start-mirror-maker-2>Start Mirror Maker 2<a class=headerlink href=#start-mirror-maker-2 title="Permanent link">&para;</a></h2> <p>In this section, we are going to go through the steps to get Mirror Maker 2 running locally on your workstation and configure it so that it replicates the messages from the <code>products</code> topic in your IBM Event Streams instance running on OpenShift to the local Strimzi Kafka cluster you deployed in the previous section as the target cluster for those messages.</p> <ol> <li> <p>Make sure you are in <code>refarch-eda-tools/labs/mirror-maker2/es-cp4i-to-local</code> and you have done all steps in the <a href=#scenario-prerequisites>Scenario Prerequisites</a> section.</p> </li> <li> <p>Start your local Mirror Maker 2 instance by executing the following bash script.</p> </li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>./launchMM2.sh
</code></pre></div> <ol> <li>After quite some long output on your screen, you should see the following messages with the name of your topic. Don't worry if you dont find these as there is a lot of ouput. You will make sure the messages are replicated in the next section.</li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>INFO<span class=w> </span><span class=o>[</span>Consumer<span class=w> </span><span class=nv>clientId</span><span class=o>=</span>consumer-null-14,<span class=w> </span><span class=nv>groupId</span><span class=o>=</span>null<span class=o>]</span><span class=w> </span>Subscribed<span class=w> </span>to<span class=w> </span>partition<span class=o>(</span>s<span class=o>)</span>:<span class=w> </span>products-0<span class=w> </span><span class=o>(</span>org.apache.kafka.clients.consumer.KafkaConsumer:1120<span class=o>)</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>INFO<span class=w> </span>Starting<span class=w> </span>with<span class=w> </span><span class=m>1</span><span class=w> </span>previously<span class=w> </span>uncommitted<span class=w> </span>partitions.<span class=w> </span><span class=o>(</span>org.apache.kafka.connect.mirror.MirrorSourceTask:94<span class=o>)</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>INFO<span class=w> </span><span class=o>[</span>Consumer<span class=w> </span><span class=nv>clientId</span><span class=o>=</span>consumer-null-14,<span class=w> </span><span class=nv>groupId</span><span class=o>=</span>null<span class=o>]</span><span class=w> </span>Seeking<span class=w> </span>to<span class=w> </span>offset<span class=w> </span><span class=m>0</span><span class=w> </span><span class=k>for</span><span class=w> </span>partition<span class=w> </span>products-0<span class=w> </span><span class=o>(</span>org.apache.kafka.clients.consumer.KafkaConsumer:1596<span class=o>)</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>INFO<span class=w> </span><span class=o>[</span>Consumer<span class=w> </span><span class=nv>clientId</span><span class=o>=</span>consumer-null-15,<span class=w> </span><span class=nv>groupId</span><span class=o>=</span>null<span class=o>]</span><span class=w> </span>Subscribed<span class=w> </span>to<span class=w> </span>partition<span class=o>(</span>s<span class=o>)</span>:<span class=w> </span>heartbeats-0<span class=w> </span><span class=o>(</span>org.apache.kafka.clients.consumer.KafkaConsumer:1120<span class=o>)</span>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>INFO<span class=w> </span>task-thread-MirrorSourceConnector-0<span class=w> </span>replicating<span class=w> </span><span class=m>1</span><span class=w> </span>topic-partitions<span class=w> </span>es-cp4i-&gt;target:<span class=w> </span><span class=o>[</span>products-0<span class=o>]</span>.<span class=w> </span><span class=o>(</span>org.apache.kafka.connect.mirror.MirrorSourceTask:98<span class=o>)</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>INFO<span class=w> </span>WorkerSourceTask<span class=o>{</span><span class=nv>id</span><span class=o>=</span>MirrorSourceConnector-0<span class=o>}</span><span class=w> </span>Source<span class=w> </span>task<span class=w> </span>finished<span class=w> </span>initialization<span class=w> </span>and<span class=w> </span>start<span class=w> </span><span class=o>(</span>org.apache.kafka.connect.runtime.WorkerSourceTask:233<span class=o>)</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>INFO<span class=w> </span>Starting<span class=w> </span>with<span class=w> </span><span class=m>1</span><span class=w> </span>previously<span class=w> </span>uncommitted<span class=w> </span>partitions.<span class=w> </span><span class=o>(</span>org.apache.kafka.connect.mirror.MirrorSourceTask:94<span class=o>)</span>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>INFO<span class=w> </span><span class=o>[</span>Consumer<span class=w> </span><span class=nv>clientId</span><span class=o>=</span>consumer-null-15,<span class=w> </span><span class=nv>groupId</span><span class=o>=</span>null<span class=o>]</span><span class=w> </span>Seeking<span class=w> </span>to<span class=w> </span>offset<span class=w> </span><span class=m>0</span><span class=w> </span><span class=k>for</span><span class=w> </span>partition<span class=w> </span>heartbeats-0<span class=w> </span><span class=o>(</span>org.apache.kafka.clients.consumer.KafkaConsumer:1596<span class=o>)</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>INFO<span class=w> </span>task-thread-MirrorSourceConnector-1<span class=w> </span>replicating<span class=w> </span><span class=m>1</span><span class=w> </span>topic-partitions<span class=w> </span>es-cp4i-&gt;target:<span class=w> </span><span class=o>[</span>heartbeats-0<span class=o>]</span>.<span class=w> </span><span class=o>(</span>org.apache.kafka.connect.mirror.MirrorSourceTask:98<span class=o>)</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>INFO<span class=w> </span>WorkerSourceTask<span class=o>{</span><span class=nv>id</span><span class=o>=</span>MirrorSourceConnector-1<span class=o>}</span><span class=w> </span>Source<span class=w> </span>task<span class=w> </span>finished<span class=w> </span>initialization<span class=w> </span>and<span class=w> </span>start<span class=w> </span><span class=o>(</span>org.apache.kafka.connect.runtime.WorkerSourceTask:233<span class=o>)</span>
</code></pre></div> <h2 id=start-consumer-from-target-cluster>Start consumer from target cluster<a class=headerlink href=#start-consumer-from-target-cluster title="Permanent link">&para;</a></h2> <p>In this section, we are going to start a consumer to consume messages from the target cluster (your local Strimzi Kafka cluster) to make sure we receive mirrored messages from your source cluster (your IBM Event Streams instance running on OpenShift). We are going to use a couple of Apache Kafka tools comming with the open source Strimzi Kafka Docker image you already have running.</p> <ol> <li>Make sure your target mirrored topic has been created executing the following command on a new terminal window.</li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>docker<span class=w> </span><span class=nb>exec</span><span class=w> </span>kafka2<span class=w> </span>bash<span class=w> </span>-c<span class=w> </span><span class=s2>&quot;/opt/kafka/bin/kafka-topics.sh --list --bootstrap-server kafka1:9091&quot;</span><span class=w> </span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>__consumer_offsets
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>es-cp4i.checkpoints.internal
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>es-cp4i.heartbeats
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>es-cp4i.products
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>heartbeats
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>mm2-configs.es-cp4i.internal
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>mm2-offsets.es-cp4i.internal
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>mm2-status.es-cp4i.internal
</code></pre></div> <p>You should see a topic called <code>es-cp4i.YOUR_TOPIC</code> where <code>YOUR_TOPIC</code> should be the name of the topic you created before in the <a href=#scenario-prerequisites>Scenario Prerequisites</a> section.</p> <ol> <li>Now, execute the following command replacing the <code>TOPIC_NAME</code> placeholder with the name of the topic you verified above (<code>ex-cp4i.YOUR_TOPIC</code>)</li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>docker<span class=w> </span><span class=nb>exec</span><span class=w> </span>-ti<span class=w> </span>kafka2<span class=w> </span>bash<span class=w> </span>-c<span class=w> </span><span class=s2>&quot;/opt/kafka/bin/kafka-console-consumer.sh --bootstrap-server kafka1:9091 --topic TOPIC_NAME --from-beginning&quot;</span><span class=w> </span>
</code></pre></div> <ol> <li>You should see the mirrored messages now in your replicated topic in your target local Strimzi Kafka cluster</li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=o>{</span><span class=s2>&quot;product_id&quot;</span>:<span class=w> </span><span class=s2>&quot;P01&quot;</span>,<span class=w> </span><span class=s2>&quot;description&quot;</span>:<span class=w> </span><span class=s2>&quot;Carrots&quot;</span>,<span class=w> </span><span class=s2>&quot;target_temperature&quot;</span>:<span class=w> </span><span class=m>4</span>,<span class=w> </span><span class=s2>&quot;target_humidity_level&quot;</span>:<span class=w> </span><span class=m>0</span>.4,<span class=w> </span><span class=s2>&quot;content_type&quot;</span>:<span class=w> </span><span class=m>1</span><span class=o>}</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=o>{</span><span class=s2>&quot;product_id&quot;</span>:<span class=w> </span><span class=s2>&quot;P02&quot;</span>,<span class=w> </span><span class=s2>&quot;description&quot;</span>:<span class=w> </span><span class=s2>&quot;Banana&quot;</span>,<span class=w> </span><span class=s2>&quot;target_temperature&quot;</span>:<span class=w> </span><span class=m>6</span>,<span class=w> </span><span class=s2>&quot;target_humidity_level&quot;</span>:<span class=w> </span><span class=m>0</span>.6,<span class=w> </span><span class=s2>&quot;content_type&quot;</span>:<span class=w> </span><span class=m>2</span><span class=o>}</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=o>{</span><span class=s2>&quot;product_id&quot;</span>:<span class=w> </span><span class=s2>&quot;P03&quot;</span>,<span class=w> </span><span class=s2>&quot;description&quot;</span>:<span class=w> </span><span class=s2>&quot;Salad&quot;</span>,<span class=w> </span><span class=s2>&quot;target_temperature&quot;</span>:<span class=w> </span><span class=m>4</span>,<span class=w> </span><span class=s2>&quot;target_humidity_level&quot;</span>:<span class=w> </span><span class=m>0</span>.4,<span class=w> </span><span class=s2>&quot;content_type&quot;</span>:<span class=w> </span><span class=m>1</span><span class=o>}</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=o>{</span><span class=s2>&quot;product_id&quot;</span>:<span class=w> </span><span class=s2>&quot;P04&quot;</span>,<span class=w> </span><span class=s2>&quot;description&quot;</span>:<span class=w> </span><span class=s2>&quot;Avocado&quot;</span>,<span class=w> </span><span class=s2>&quot;target_temperature&quot;</span>:<span class=w> </span><span class=m>6</span>,<span class=w> </span><span class=s2>&quot;target_humidity_level&quot;</span>:<span class=w> </span><span class=m>0</span>.4,<span class=w> </span><span class=s2>&quot;content_type&quot;</span>:<span class=w> </span><span class=m>1</span><span class=o>}</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=o>{</span><span class=s2>&quot;product_id&quot;</span>:<span class=w> </span><span class=s2>&quot;P05&quot;</span>,<span class=w> </span><span class=s2>&quot;description&quot;</span>:<span class=w> </span><span class=s2>&quot;Tomato&quot;</span>,<span class=w> </span><span class=s2>&quot;target_temperature&quot;</span>:<span class=w> </span><span class=m>4</span>,<span class=w> </span><span class=s2>&quot;target_humidity_level&quot;</span>:<span class=w> </span><span class=m>0</span>.4,<span class=w> </span><span class=s2>&quot;content_type&quot;</span>:<span class=w> </span><span class=m>2</span><span class=o>}</span>
</code></pre></div> <h2 id=clean-up>Clean up<a class=headerlink href=#clean-up title="Permanent link">&para;</a></h2> <p>You have now successfully finished the lab. You can stop the consumer and the Mirror Maker 2 console output pressing <code>ctrl+c</code> in their respective terminals. You can also stop and remove the Docker containers for both the Mirror Maker 2 and Strimzi Kafka clusters running on your workstation by executing the following script:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>./cleanLab.sh
</code></pre></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright © 2022 IBM </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/ibm-cloud-architecture target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/agileitarchitecture target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.annotate", "content.tooltips", "navigation.instant", "navigation.tabs.sticky", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.1e8ae164.min.js></script> </body> </html>