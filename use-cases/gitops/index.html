<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Event-driven solution GitOps approach"><meta name=author content="Jerome Boyer"><link href=https://ibm-cloud-architecture.github.com/refarch-eda/use-cases/gitops/ rel=canonical><link href=../../technology/spring/ rel=prev><link href=../../technology/event-streams/es-cp4i/ rel=next><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.17"><title>Event-driven solution GitOps approach - IBM Automation - Event-driven Solution - Sharing knowledge</title><link rel=stylesheet href=../../assets/stylesheets/main.bcfcd587.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#overview class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="IBM Automation - Event-driven Solution - Sharing knowledge" class="md-header__button md-logo" aria-label="IBM Automation - Event-driven Solution - Sharing knowledge" data-md-component=logo> <img src=../../images/es-icon.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> IBM Automation - Event-driven Solution - Sharing knowledge </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Event-driven solution GitOps approach </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ibm-cloud-architecture/refarch-eda title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> ibm-cloud-architecture/refarch-eda </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="IBM Automation - Event-driven Solution - Sharing knowledge" class="md-nav__button md-logo" aria-label="IBM Automation - Event-driven Solution - Sharing knowledge" data-md-component=logo> <img src=../../images/es-icon.png alt=logo> </a> IBM Automation - Event-driven Solution - Sharing knowledge </label> <div class=md-nav__source> <a href=https://github.com/ibm-cloud-architecture/refarch-eda title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> ibm-cloud-architecture/refarch-eda </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../news/ class=md-nav__link> <span class=md-ellipsis> What's new </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Introduction </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Introduction </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../introduction/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../introduction/reference-architecture/ class=md-nav__link> <span class=md-ellipsis> Reference Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../introduction/usecases/ class=md-nav__link> <span class=md-ellipsis> Business Use Cases </span> </a> </li> <li class=md-nav__item> <a href=../../introduction/target-audiences/ class=md-nav__link> <span class=md-ellipsis> Target Audiences </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Learning Journey </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Learning Journey </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../journey/101/ class=md-nav__link> <span class=md-ellipsis> Get started (101 content) </span> </a> </li> <li class=md-nav__item> <a href=../../journey/201/ class=md-nav__link> <span class=md-ellipsis> Deeper dive (201 content) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Concepts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../concepts/terms-and-definitions/ class=md-nav__link> <span class=md-ellipsis> Terms & Definitions </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/integration/ class=md-nav__link> <span class=md-ellipsis> Agile Integration </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/events-versus-messages/ class=md-nav__link> <span class=md-ellipsis> Event streaming versus Queuing </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/fit-to-purpose/ class=md-nav__link> <span class=md-ellipsis> Fit for purpose </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/model/ class=md-nav__link> <span class=md-ellipsis> Devising the data models </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/flow-architectures/ class=md-nav__link> <span class=md-ellipsis> Flow Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/service-mesh/ class=md-nav__link> <span class=md-ellipsis> Service mesh </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Advantages of EDA </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Advantages of EDA </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../advantages/microservice/ class=md-nav__link> <span class=md-ellipsis> Microservice decoupling </span> </a> </li> <li class=md-nav__item> <a href=../../advantages/reactive/ class=md-nav__link> <span class=md-ellipsis> Reactive systems </span> </a> </li> <li class=md-nav__item> <a href=../../advantages/resiliency/ class=md-nav__link> <span class=md-ellipsis> Resiliency </span> </a> </li> <li class=md-nav__item> <a href=../../advantages/scalability/ class=md-nav__link> <span class=md-ellipsis> Scalability </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Patterns in EDA </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Patterns in EDA </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../patterns/intro/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../patterns/event-sourcing/ class=md-nav__link> <span class=md-ellipsis> Event Sourcing </span> </a> </li> <li class=md-nav__item> <a href=../../patterns/cqrs/ class=md-nav__link> <span class=md-ellipsis> CQRS </span> </a> </li> <li class=md-nav__item> <a href=../../patterns/saga/ class=md-nav__link> <span class=md-ellipsis> Saga </span> </a> </li> <li class=md-nav__item> <a href=../../patterns/dlq/ class=md-nav__link> <span class=md-ellipsis> Dead Letter Queue </span> </a> </li> <li class=md-nav__item> <a href=../../patterns/topic-replication/ class=md-nav__link> <span class=md-ellipsis> Topic Replication </span> </a> </li> <li class=md-nav__item> <a href=../../patterns/data-pipeline/ class=md-nav__link> <span class=md-ellipsis> Data Intensive App </span> </a> </li> <li class=md-nav__item> <a href=../../patterns/realtime-analytics/ class=md-nav__link> <span class=md-ellipsis> Near real-time analytics </span> </a> </li> <li class=md-nav__item> <a href=../../patterns/api-mgt/ class=md-nav__link> <span class=md-ellipsis> API management </span> </a> </li> <li class=md-nav__item> <a href=../../patterns/cep/ class=md-nav__link> <span class=md-ellipsis> Situational decision </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Methodology </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Methodology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../methodology/event-storming/ class=md-nav__link> <span class=md-ellipsis> Event Storming </span> </a> </li> <li class=md-nav__item> <a href=../../methodology/domain-driven-design/ class=md-nav__link> <span class=md-ellipsis> Domain-Driven Design </span> </a> </li> <li class=md-nav__item> <a href=../../methodology/data-intensive/ class=md-nav__link> <span class=md-ellipsis> Data Intensive App Development </span> </a> </li> <li class=md-nav__item> <a href=../../methodology/data-lineage/ class=md-nav__link> <span class=md-ellipsis> Data lineage </span> </a> </li> <li class=md-nav__item> <a href=../../methodology/governance/ class=md-nav__link> <span class=md-ellipsis> Governance </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Technology </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Technology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../technology/kafka-overview/ class=md-nav__link> <span class=md-ellipsis> Kafka Overview </span> </a> </li> <li class=md-nav__item> <a href=../../technology/event-streams/ class=md-nav__link> <span class=md-ellipsis> Event Streams </span> </a> </li> <li class=md-nav__item> <a href=https://ibm-cloud-architecture.github.io/eda-tech-academy/demo/ class=md-nav__link> <span class=md-ellipsis> Event Streams Demo Script </span> </a> </li> <li class=md-nav__item> <a href=../../technology/faq/ class=md-nav__link> <span class=md-ellipsis> Kafka FAQ </span> </a> </li> <li class=md-nav__item> <a href=../../technology/mq/ class=md-nav__link> <span class=md-ellipsis> MQ in EDA context </span> </a> </li> <li class=md-nav__item> <a href=../../technology/kafka-producers/ class=md-nav__link> <span class=md-ellipsis> Kafka Producers </span> </a> </li> <li class=md-nav__item> <a href=../../technology/kafka-consumers/ class=md-nav__link> <span class=md-ellipsis> Kafka Consumers </span> </a> </li> <li class=md-nav__item> <a href=../../technology/avro-schemas/ class=md-nav__link> <span class=md-ellipsis> Avro Schema </span> </a> </li> <li class=md-nav__item> <a href=../../technology/advanced-kafka/ class=md-nav__link> <span class=md-ellipsis> Advanced Concepts </span> </a> </li> <li class=md-nav__item> <a href=../../technology/kafka-streams/ class=md-nav__link> <span class=md-ellipsis> Kafka Streams </span> </a> </li> <li class=md-nav__item> <a href=../../technology/kafka-connect/ class=md-nav__link> <span class=md-ellipsis> Kafka Connect </span> </a> </li> <li class=md-nav__item> <a href=../../technology/event-streams/es-maas/security/ class=md-nav__link> <span class=md-ellipsis> Kafka security </span> </a> </li> <li class=md-nav__item> <a href=../../technology/kafka-monitoring/ class=md-nav__link> <span class=md-ellipsis> Kafka Monitoring </span> </a> </li> <li class=md-nav__item> <a href=../../technology/kafka-mirrormaker/ class=md-nav__link> <span class=md-ellipsis> Mirror Maker 2 </span> </a> </li> <li class=md-nav__item> <a href=../../technology/security/ class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> <li class=md-nav__item> <a href=../../technology/flink/ class=md-nav__link> <span class=md-ellipsis> Apache Flink </span> </a> </li> <li class=md-nav__item> <a href=../../technology/spring/ class=md-nav__link> <span class=md-ellipsis> Spring cloud </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_10 checked> <label class=md-nav__link for=__nav_10 id=__nav_10_label tabindex=0> <span class=md-ellipsis> Use Cases </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=true> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> Use Cases </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Event-driven solution GitOps </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Event-driven solution GitOps </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> <nav class=md-nav aria-label=Overview> <ul class=md-nav__list> <li class=md-nav__item> <a href=#system-context class=md-nav__link> <span class=md-ellipsis> System context </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#components-for-gitops class=md-nav__link> <span class=md-ellipsis> Components for GitOps </span> </a> <nav class=md-nav aria-label="Components for GitOps"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#event-driven-applications class=md-nav__link> <span class=md-ellipsis> Event-driven applications </span> </a> </li> <li class=md-nav__item> <a href=#event-streaming-applications class=md-nav__link> <span class=md-ellipsis> Event-streaming applications </span> </a> </li> <li class=md-nav__item> <a href=#queue-manager class=md-nav__link> <span class=md-ellipsis> Queue manager </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#openshift-gitops-or-argocd class=md-nav__link> <span class=md-ellipsis> OpenShift GitOps or ArgoCD </span> </a> <nav class=md-nav aria-label="OpenShift GitOps or ArgoCD"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#openshift-pipelines-or-tekton class=md-nav__link> <span class=md-ellipsis> OpenShift Pipelines or Tekton </span> </a> </li> <li class=md-nav__item> <a href=#queue-manager_1 class=md-nav__link> <span class=md-ellipsis> Queue manager </span> </a> </li> <li class=md-nav__item> <a href=#sealed-secrets class=md-nav__link> <span class=md-ellipsis> Sealed secrets </span> </a> </li> <li class=md-nav__item> <a href=#image-registry class=md-nav__link> <span class=md-ellipsis> Image Registry </span> </a> </li> <li class=md-nav__item> <a href=#cert-manager class=md-nav__link> <span class=md-ellipsis> Cert manager </span> </a> </li> <li class=md-nav__item> <a href=#prometheus class=md-nav__link> <span class=md-ellipsis> Prometheus </span> </a> </li> <li class=md-nav__item> <a href=#kustomize class=md-nav__link> <span class=md-ellipsis> Kustomize </span> </a> </li> <li class=md-nav__item> <a href=#github class=md-nav__link> <span class=md-ellipsis> GitHub </span> </a> </li> <li class=md-nav__item> <a href=#openshift-kubernetes-cluster class=md-nav__link> <span class=md-ellipsis> OpenShift (Kubernetes) Cluster </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#high-level-architecture-view class=md-nav__link> <span class=md-ellipsis> High-level architecture view </span> </a> <nav class=md-nav aria-label="High-level architecture view"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gitops-model class=md-nav__link> <span class=md-ellipsis> GitOps Model </span> </a> </li> <li class=md-nav__item> <a href=#github-repositories class=md-nav__link> <span class=md-ellipsis> GitHub repositories </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#examples-of-solution-gitops class=md-nav__link> <span class=md-ellipsis> Examples of solution GitOps </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../technology/event-streams/es-cp4i/ class=md-nav__link> <span class=md-ellipsis> Deploy Event-Streams </span> </a> </li> <li class=md-nav__item> <a href=../connect-s3/ class=md-nav__link> <span class=md-ellipsis> Kafka Connect - S3 </span> </a> </li> <li class=md-nav__item> <a href=../connect-cos/ class=md-nav__link> <span class=md-ellipsis> Kafka Connect - COS </span> </a> </li> <li class=md-nav__item> <a href=../connect-jdbc/ class=md-nav__link> <span class=md-ellipsis> Kafka Connect - jdbc </span> </a> </li> <li class=md-nav__item> <a href=../connect-mq/ class=md-nav__link> <span class=md-ellipsis> Kafka Connect - MQ </span> </a> </li> <li class=md-nav__item> <a href=../connect-rabbitmq/ class=md-nav__link> <span class=md-ellipsis> Kafka Connect - Rabbitmq </span> </a> </li> <li class=md-nav__item> <a href=../kafka-streams/ class=md-nav__link> <span class=md-ellipsis> Kafka Streams labs </span> </a> </li> <li class=md-nav__item> <a href=../db2-debezium/ class=md-nav__link> <span class=md-ellipsis> DB2 - CDC Debezium - Outbox </span> </a> </li> <li class=md-nav__item> <a href=../kafka-mm2/ class=md-nav__link> <span class=md-ellipsis> Mirror maker 2 labs </span> </a> </li> <li class=md-nav__item> <a href=../schema-registry-on-cloud/ class=md-nav__link> <span class=md-ellipsis> Schema registry ES on Cloud </span> </a> </li> <li class=md-nav__item> <a href=../schema-registry-on-ocp/ class=md-nav__link> <span class=md-ellipsis> Schema registry </span> </a> </li> <li class=md-nav__item> <a href=../monitoring-on-cloud/ class=md-nav__link> <span class=md-ellipsis> Monitoring ES on Cloud </span> </a> </li> <li class=md-nav__item> <a href=../monitoring-on-ocp/ class=md-nav__link> <span class=md-ellipsis> Monitoring ES </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_11> <label class=md-nav__link for=__nav_11 id=__nav_11_label tabindex=0> <span class=md-ellipsis> Scenarios </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_11_label aria-expanded=false> <label class=md-nav__title for=__nav_11> <span class="md-nav__icon md-icon"></span> Scenarios </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../scenarios/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=https://ibm-cloud-architecture.github.io/refarch-kc/ class=md-nav__link> <span class=md-ellipsis> Reefer Shipment Solution </span> </a> </li> <li class=md-nav__item> <a href=https://ibm-cloud-architecture.github.io/vaccine-solution-main/ class=md-nav__link> <span class=md-ellipsis> Vaccine at Scale </span> </a> </li> <li class=md-nav__item> <a href=https://ibm-cloud-architecture.github.io/eda-rt-inventory-gitops class=md-nav__link> <span class=md-ellipsis> Near real-time Inventory </span> </a> </li> <li class=md-nav__item> <a href=../../scenarios/saga-orchestration/ class=md-nav__link> <span class=md-ellipsis> SAGA with MQ Orchestration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../additional-reading/ class=md-nav__link> <span class=md-ellipsis> Additional reading </span> </a> </li> <li class=md-nav__item> <a href=../../contribute/ class=md-nav__link> <span class=md-ellipsis> Contribute to this Site </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> <nav class=md-nav aria-label=Overview> <ul class=md-nav__list> <li class=md-nav__item> <a href=#system-context class=md-nav__link> <span class=md-ellipsis> System context </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#components-for-gitops class=md-nav__link> <span class=md-ellipsis> Components for GitOps </span> </a> <nav class=md-nav aria-label="Components for GitOps"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#event-driven-applications class=md-nav__link> <span class=md-ellipsis> Event-driven applications </span> </a> </li> <li class=md-nav__item> <a href=#event-streaming-applications class=md-nav__link> <span class=md-ellipsis> Event-streaming applications </span> </a> </li> <li class=md-nav__item> <a href=#queue-manager class=md-nav__link> <span class=md-ellipsis> Queue manager </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#openshift-gitops-or-argocd class=md-nav__link> <span class=md-ellipsis> OpenShift GitOps or ArgoCD </span> </a> <nav class=md-nav aria-label="OpenShift GitOps or ArgoCD"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#openshift-pipelines-or-tekton class=md-nav__link> <span class=md-ellipsis> OpenShift Pipelines or Tekton </span> </a> </li> <li class=md-nav__item> <a href=#queue-manager_1 class=md-nav__link> <span class=md-ellipsis> Queue manager </span> </a> </li> <li class=md-nav__item> <a href=#sealed-secrets class=md-nav__link> <span class=md-ellipsis> Sealed secrets </span> </a> </li> <li class=md-nav__item> <a href=#image-registry class=md-nav__link> <span class=md-ellipsis> Image Registry </span> </a> </li> <li class=md-nav__item> <a href=#cert-manager class=md-nav__link> <span class=md-ellipsis> Cert manager </span> </a> </li> <li class=md-nav__item> <a href=#prometheus class=md-nav__link> <span class=md-ellipsis> Prometheus </span> </a> </li> <li class=md-nav__item> <a href=#kustomize class=md-nav__link> <span class=md-ellipsis> Kustomize </span> </a> </li> <li class=md-nav__item> <a href=#github class=md-nav__link> <span class=md-ellipsis> GitHub </span> </a> </li> <li class=md-nav__item> <a href=#openshift-kubernetes-cluster class=md-nav__link> <span class=md-ellipsis> OpenShift (Kubernetes) Cluster </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#high-level-architecture-view class=md-nav__link> <span class=md-ellipsis> High-level architecture view </span> </a> <nav class=md-nav aria-label="High-level architecture view"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gitops-model class=md-nav__link> <span class=md-ellipsis> GitOps Model </span> </a> </li> <li class=md-nav__item> <a href=#github-repositories class=md-nav__link> <span class=md-ellipsis> GitHub repositories </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#examples-of-solution-gitops class=md-nav__link> <span class=md-ellipsis> Examples of solution GitOps </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Event-driven solution GitOps</h1> <div class="admonition info"> <p class=admonition-title>Info</p> <p>Updated 2/15/2022</p> </div> <p><strong>Audience</strong>: Architects, Application developers, Site reliability engineers, Administrators</p> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>The purpose of the tutorial is to teach architects, developers and operations staff how to deploy a production-ready event-driven solution <a href=http://openshift.com>OpenShift Container Platform</a>. It makes extensive use of the <a href=https://cloud.ibm.com/docs/cloud-pak-integration>IBM Cloud Pak for Integration (CP4I)</a> and other <a href=(https://landscape.cncf.io/)>cloud native technologies</a> such as Tekton, Kustomize, ArgoCD, Prometheus, Grafana and Kibana.</p> <p>GitOps is a declarative way to implement continuous deployment for cloud-native applications. The Red Hat® OpenShift® Container Platform offers the <a href=https://docs.openshift.com/container-platform/4.7/cicd/gitops/understanding-openshift-gitops.html>OpenShift GitOps operator</a>, which manages the entire lifecycle for <a href=https://argoproj.github.io/argo-cd/ >Argo CD</a> and its components.</p> <p>Argo applications are added to the Argo CD server. An application defines the source of the Kubernetes resources and the target cluster where those resources should be deployed. The Argo CD server "installs" a Cloud Pak by synchronizing the applications representing the Cloud Pak into the target cluster.</p> <h3 id=system-context>System context<a class=headerlink href=#system-context title="Permanent link">&para;</a></h3> <p>A <a href=https://en.wikipedia.org/wiki/System_context_diagram>system context</a> diagram helps us understand how our system interacts with its different users and other systems. For a generic event-driven solution the diagram looks like</p> <p><img alt=system-context src=images/eda-gitops.png width=600></p> <p>We can see the different entities that interact with a typical event-driven solution deployment. These include users as well as applications and messaging as a service infrastructure which includes event backbone, queueing systems, schema registry, API management, governance platform and monitoring components.</p> <p>We'll be developing the Event-driven solution deployment at the centre of the diagram. We can see that it connects applications to systems and infrastructure. Its users are at least developers, SREs, Kubernetes administrators, architects...</p> <h2 id=components-for-gitops>Components for GitOps<a class=headerlink href=#components-for-gitops title="Permanent link">&para;</a></h2> <p>The following diagram shows the technical components used in a typical event-driven solution production deployment.</p> <p><img alt=components src=images/components.png width=1000></p> <p>(<em>the source code of this diagram is a <code>`.drawio</code> format and is in the <a href=https://github.com/ibm-cloud-architecture/refarch-eda/edit/master/docs/src/pages/use-cases/gitops/diagrams>diagrams folder</a>.</em>)</p> <p>The diagram organizes the components according to when they are introduced in system development (earlier or later) and whether they are a relatively high level application-oriented component, or a relatively low level system- oriented component. For example, GitHub is a system component that is fundamental to how we structure the event-driven solution deployment. In contrast, streaming or event-driven applications are higher level components, and requires other components to be deployed prior to them.</p> <p>The color coding illustrates that blue components are part of the solution, red are part of the GitOps on OpenShift and green components are externals to OpenShit cluster, most likely event if they could be. Kustomize represents way to define deployment, and Sealed secret is a service to manage secrets.</p> <p>As part of the later components to deploy, we have addressed everything to monitor the solution and the infrastructure. </p> <p>Here is a brief introduction of those components:</p> <h3 id=event-driven-applications>Event-driven applications<a class=headerlink href=#event-driven-applications title="Permanent link">&para;</a></h3> <p>Those applications are supporting business logic, microservice based, and using Reactive messaging, MQ or Kafka APIs. Those applications provide OpenAPIs to the mobile or web applications but also AsyncAPI when they produce events to Kafka or messages to MQ. OpenAPI and AsyncAPI definitions are managed by API manager and event end-point manager. </p> <p>Schema definitions are managed by a <strong>Schema Registry</strong>.</p> <hr> <h3 id=event-streaming-applications>Event-streaming applications<a class=headerlink href=#event-streaming-applications title="Permanent link">&para;</a></h3> <p>Those applications are also supporting business logic, but more with stateful processing using <a href=../../technology/kafka-streams/ >Kafka Stream</a> APIs or different product such as <a href=../../technology/flink/ >Apache Flink</a>.</p> <hr> <h3 id=queue-manager>Queue manager<a class=headerlink href=#queue-manager title="Permanent link">&para;</a></h3> <p>A queue manager provides queueing services via one of the many MQ APIs. A queue manager hosts the queues that store the messages produced and consumed by connected applications and systems. Queue managers can be connected together via network channels to allow messages to flow between disparate systems and applications on different platforms including on-premise and cloud systems.</p> <hr> <h2 id=openshift-gitops-or-argocd>OpenShift GitOps or ArgoCD<a class=headerlink href=#openshift-gitops-or-argocd title="Permanent link">&para;</a></h2> <p>OpenShift GitOps (ArgoCD) is used for the continuous deployment of software components to the Kubernetes cluster. OpenShift GitOps watches a Git repository for new or changed Kubernetes resource definitions, and applies them to a cluster. In this way, OpenShift GitOps ensures that the component configuration stored in GitHub always reflects the state of the cluster.</p> <p>OpenShift GitOps also has the added benefit of being able to monitor resources that it has deployed to ensure that if they drift from their desired values, they will be automatically restored to those values by OpenShift GitOps.</p> <hr> <h3 id=openshift-pipelines-or-tekton>OpenShift Pipelines or Tekton<a class=headerlink href=#openshift-pipelines-or-tekton title="Permanent link">&para;</a></h3> <p>OpenShift Pipelines (Tekton) is used to automate manual tasks using the concept of a pipeline. A pipeline comprises a set of tasks that are executed in a specified order in order to accomplish a specific objective.</p> <p>We use pipelines as part of the continuous integration process to build, test and deliver event-driven applications ready for deployment by OpenShift GitOps.</p> <h3 id=queue-manager_1>Queue manager<a class=headerlink href=#queue-manager_1 title="Permanent link">&para;</a></h3> <p>A queue manager provides queueing services via one of the many MQ APIs. A queue manager hosts the queues that store the messages produced and consumed by connected applications and systems. Queue managers can be connected together via network channels to allow messages to flow between disparate systems and applications on different platforms including on-premise and cloud systems.</p> <hr> <h3 id=sealed-secrets>Sealed secrets<a class=headerlink href=#sealed-secrets title="Permanent link">&para;</a></h3> <p>Very often a component has a Kubernetes secret associated with it. Inside the secret might be a private key to access the IBM entitled container registry, for example. For obvious reasons, we don't want to store the secrets in GitHub with the rest of the configuration.</p> <p>A <a href=https://github.com/bitnami-labs/sealed-secrets>sealed secret</a> solves this problem by introducing a new kind of Kubernetes resource. A sealed secret is created from a regular secret, and can be safely stored in a Git repository. A deployment time, the sealed secret controller will recreate the secret in its original form so that it can be access by components with the appropriate RBAC authority.</p> <hr> <h3 id=image-registry>Image Registry<a class=headerlink href=#image-registry title="Permanent link">&para;</a></h3> <p>OpenShift contains a registry for storing container images. Images are built and stored by OpenShift Pipelines as part of the CICD process. Tekton pipelines and ArgoCD also retrieve the latest best images from the image registry to ensure that what's being tested or deployed in higher environments is the same as what's tested in development environments.</p> <p>We often refer to uploading images as <em>pushing</em> and downloading images as <em>pulling</em>.</p> <hr> <h3 id=cert-manager>Cert manager<a class=headerlink href=#cert-manager title="Permanent link">&para;</a></h3> <p>Managing certificates is a difficult process; certificate creation requires a Certificate Authority (CA), certificates expire after a period of time, and private keys can sometimes be compromised -- requiring a certificate to be revoked and a new one issued.</p> <p>Cert manager makes all these processes relatively straightforward by introducing new Kubernetes resources for certificate issuers and certificates. These resource types radically simplify the management of certificates: their creation, expiry and revocation.</p> <p>Moreover, Cert manager makes it feasible to adopt mutual TLS (mTLS) as an authorization strategy in Kafka based solution.</p> <h3 id=prometheus>Prometheus<a class=headerlink href=#prometheus title="Permanent link">&para;</a></h3> <p>Prometheus is used in conjunction with Grafana. It stores the different component's metrics as a set of tuples in a time-series , which allows it to be subsequently used to create Grafana views to assist with monitoring Kafka brokers, MQ queue managers, schema registry....</p> <hr> <h3 id=kustomize>Kustomize<a class=headerlink href=#kustomize title="Permanent link">&para;</a></h3> <p>Kubernetes resources have their operational properties defined using YAMLs. As these resources move through environments such as dev, stage and prod, <a href=https://kustomize.io/ >Kustomize</a> provides a natural way to adapt (<em>customize</em>!) these YAMLs to these environments. For example, we might want to change the CPU or memory available to a service in a production environment compared to a development environment.</p> <p>Because <a href=https://kustomize.io/ >Kustomize</a> is built into the <code>kubectl</code> and <code>oc</code> commands via the <code>-k</code> option, it makes configuration management both easy and natural.</p> <hr> <h3 id=github>GitHub<a class=headerlink href=#github title="Permanent link">&para;</a></h3> <p>This popular version control system is based on git and stores the event-driven application source code and configuration as well as the other Kubernetes resources. By keeping our event-driven applications and configurations in Git, and using that to build, test and deploy our applications to the Kubernetes cluster, we have a <strong>single source of truth</strong> -- what's in Git is running in the cluster.</p> <p>Moreover, by using Git operations such as <em>pull</em>, <em>push</em> and <em>merge</em> to make changes, we can exploit the extensive governance and change control provided by Git when managing our event-driven solution estate.</p> <hr> <h3 id=openshift-kubernetes-cluster>OpenShift (Kubernetes) Cluster<a class=headerlink href=#openshift-kubernetes-cluster title="Permanent link">&para;</a></h3> <p>This is the "operating system" used to orchestrate our applications and related component containers. Kubernetes is portable across on-premise and cloud systems and allows us to easily scale our workloads across these environments as required.</p> <hr> <h2 id=high-level-architecture-view>High-level architecture view<a class=headerlink href=#high-level-architecture-view title="Permanent link">&para;</a></h2> <p>Using a GitOps approach we can design a high-level architecture view for the deployment of all the previously listed components. It is important to recall that most of the RedHat and IBM products used in event-driven solution are using Operators and Custom resources manifests to deploy operands.</p> <p><strong><a href=https://github.com/operator-framework>Operator</a></strong> is a long running process that performs products (Operands) deployment and Day 2 operations, like upgrades, failover, or scaling. Operator is constantly watching your cluster’s desired state for the software installed. Helm and Operators represent two different phases in managing complex application workloads on Kubernetes. Helm’s primary focus is on the day-1 operation of deploying Kubernetes artifacts in a cluster. The ‘domain’ that it understands is that of Kubernetes YAMLs that are composed of available Kubernetes Resources / APIs. Operators, on the other hand, are primarily focused on addressing day-2 management tasks of stateful / complex workloads such as Postgres, Cassandra, Spark, Kafka, SSL Cert Mgmt etc. on Kubernetes.</p> <p><strong>Operator Lifecycle Manager (OLM)</strong> helps you to deploy, and update, and generally manage the lifecycle of all of the Operators (and their associated services) running across your clusters</p> <p>The Operators deployment is part of a bootstraping step of the GitOps process. We are using a special Git repository to manage a catalog of operator definitions/ subscriptions. This is the goal of the <a href=https://github.com/ibm-cloud-architecture/eda-gitops-catalog>eda-gitops-catalog</a> repository.</p> <p>A solution will have a specific gitops repository that manages services (operands) and application specifics deployment manifests.</p> <p>With this base, the following figure illustrates a potential architecture:</p> <p><img alt src=images/hl-view.png width=1000></p> <p>(<em>the source code of this diagram is a <code>`.drawio</code> format and is in the <a href=https://github.com/ibm-cloud-architecture/refarch-eda/edit/master/docs/src/pages/use-cases/gitops/diagrams>diagrams folder</a>.</em>)</p> <p>Here are the assumptions we define for any event-driven solution:</p> <ul> <li>Single admin team for OCP cluster and production projects within the cluster.</li> <li>Developers manages staging and dev environment. This is a functional team developing the solution</li> <li>For the solution one gitops will define all environments and apps/services of the solution. </li> <li>Developers will not have access to OpenShift cluster administration</li> <li>Cloud Pak for integration operators are installed in all namespaces, and there is only one instance of each operator. </li> <li>Only one Platform Navigator installed per cluster (in all namespaces) and it displays instances of capabilities from the whole cluster.</li> <li><code>ibm-common-services</code> is unique to the cluster. </li> </ul> <p>For real production deployment, the production OpenShift cluster will be separated from dev and staging, running in different infrastructure, but using the same github source. The top-right cluster is for dev and staging, and each of those environmentd will be in different namespace. To enforce isolation and clear separation of concern, each of those <code>dev</code> or <code>staging</code> namespace, may have Event Streams, MQ brokers, schema registry deployed.</p> <p>The <code>openshift-operators</code> is used to deploy Operators that manage multiple namespaces. The <code>openshift-gitops</code> is for the ArgoCD server and the ArgoCD apps.</p> <h3 id=gitops-model>GitOps Model<a class=headerlink href=#gitops-model title="Permanent link">&para;</a></h3> <p><a href=https://www.gitops.tech/ >Gitops</a> is a way of implementing Continuous Deployment for containerized applications.</p> <p>The core idea of GitOps is having a Git repository that always contains declarative descriptions of the infrastructure currently desired in the production environment and an automated process to make the production environment matches the described state in the repository.</p> <p>From the diagram above, we can see two main components that are essentials to a production-ready event-driven solution deployment:</p> <ul> <li> <p>A Kubernetes cluster containing:</p> <ul> <li>event-driven applications per namespace / project to facilitate isolation</li> <li>Event Streams, API mangement, MQ operators per namespace / project </li> <li>Kafka brokers, Kafka connect, mirror maker, schema registry, End point event gateway, API manager, MQ queue managers per namespace / project </li> <li>OpenShit GitOps, Pipelines,...</li> </ul> </li> <li> <p>GitHub as a source of truth for the cluster runtime containing:</p> <ul> <li>application source with schema definitions</li> <li>application configuration</li> <li>Kafka Cluster configuration</li> <li>Topic configuration</li> <li>OpenAPI and AsyncAPI documents</li> <li>Kafka Connnector configuration</li> <li>Mirror maker configuration</li> <li>Queue manager configuration</li> </ul> </li> </ul> <h3 id=github-repositories>GitHub repositories<a class=headerlink href=#github-repositories title="Permanent link">&para;</a></h3> <p>We propose to use one GitOps Catalog to centralize the Operator subscription definitions with Kustomize overlays to control operator versioning. An example of such catalog is the <a href=https://github.com/ibm-cloud-architecture/eda-gitops-catalog>eda-gitops-catalog</a>. Each operator is defined with the subscription manifest and then overlays to change the product version. Here is an example for Event Streams:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>├──<span class=w> </span>event-streams
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>│<span class=w>   </span>│<span class=w>   </span>├──<span class=w> </span>README.md
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>│<span class=w>   </span>│<span class=w>   </span>└──<span class=w> </span>operator
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>│<span class=w>   </span>│<span class=w>       </span>├──<span class=w> </span>base
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>│<span class=w>   </span>│<span class=w>       </span>│<span class=w>   </span>├──<span class=w> </span>kustomization.yaml
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>│<span class=w>   </span>│<span class=w>       </span>│<span class=w>   </span>└──<span class=w> </span>subscription.yaml
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>│<span class=w>   </span>│<span class=w>       </span>└──<span class=w> </span>overlays
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>│<span class=w>   </span>│<span class=w>           </span>├──<span class=w> </span>kustomization.yaml
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>│<span class=w>   </span>│<span class=w>           </span>├──<span class=w> </span>v2.3
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>│<span class=w>   </span>│<span class=w>           </span>│<span class=w>   </span>├──<span class=w> </span>kustomization.yaml
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>│<span class=w>   </span>│<span class=w>           </span>│<span class=w>   </span>└──<span class=w> </span>patch-channel.yaml
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>│<span class=w>   </span>│<span class=w>           </span>├──<span class=w> </span>v2.4
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>│<span class=w>   </span>│<span class=w>           </span>│<span class=w>   </span>├──<span class=w> </span>kustomization.yaml
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>│<span class=w>   </span>│<span class=w>           </span>│<span class=w>   </span>└──<span class=w> </span>patch-channel.yaml
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>│<span class=w>   </span>│<span class=w>           </span>└──<span class=w> </span>v2.5
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>│<span class=w>   </span>│<span class=w>               </span>├──<span class=w> </span>kustomization.yaml
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>│<span class=w>   </span>│<span class=w>               </span>└──<span class=w> </span>patch-channel.yaml
</code></pre></div> <p>The subscription.yam is classical operator definition:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">operators.coreos.com/v1alpha1</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Subscription</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ibm-eventstreams</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">openshift-operators</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=w>  </span><span class=nt>channel</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">stable</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ibm-eventstreams</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=w>  </span><span class=nt>installPlanApproval</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Automatic</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=w>  </span><span class=nt>source</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ibm-operator-catalog</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=w>  </span><span class=nt>sourceNamespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">openshift-marketplace</span>
</code></pre></div> <p>And then each overlays use this manifest as a base resource and apply patch for channel and version:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># kustomization.yaml under an overlays</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=nt>bases</span><span class=p>:</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">../../base</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=nt>patchesJson6902</span><span class=p>:</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">patch-channel.yaml</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w>  </span><span class=nt>target</span><span class=p>:</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Subscription</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ibm-eventstreams</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># patch-channel.yaml</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>op</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">replace</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w>  </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/metadata/namespace</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>  </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cp4i</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>op</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">replace</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w>  </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/spec/channel</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>  </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v2.5</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>op</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">replace</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=w>  </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/spec/startingCSV</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=w>  </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ibm-eventstreams.v2.5.1</span>
</code></pre></div> <p>The second major GitOps will be for the solution itself. We use <a href=https://github.com/redhat-developer/kam>KAM CLI</a> to bootstrap its creation. KAM's goal is to help creating a GitOps project for an existing application as <a href=https://github.com/redhat-developer/kam/tree/master/docs/journey/day1>day 1 operations</a> and then add more services as part of <code>day 2 operation</code>.</p> <h2 id=examples-of-solution-gitops>Examples of solution GitOps<a class=headerlink href=#examples-of-solution-gitops title="Permanent link">&para;</a></h2> <p>The following solution GitOps repositories are illustrating the proposed approach:</p> <ul> <li><a href=https://github.com/ibm-cloud-architecture/refarch-kc-gitops>refarch-kc-gitops</a>: For the shipping fresh food overseas solution we have defined. It includes the SAGA choreography pattern implemented with Kafka</li> <li><a href=https://github.com/ibm-cloud-architecture/eda-kc-gitops>eda-kc-gitops</a>: For the shipping fresh food overseas solution we have defined. It includes the SAGA orchestration pattern implemented with MQ</li> <li><a href=https://github.com/ibm-cloud-architecture/eda-rt-inventory-gitops>eda-rt-inventory-gitops</a> to deploy the demo of real-time inventory</li> </ul> <p>As a lab example, you may want to clone the real-time inventory demo and bootstrap the GitOps apps to deploy services and apps:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>git<span class=w> </span>clone<span class=w> </span>https://github.com/ibm-cloud-architecture/eda-rt-inventory-gitops
</code></pre></div> <p>See the main readme for up to date instructions. All the images are in the public image registry: <code>quay.io/ibmcase</code></p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright © 2022 IBM </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/ibm-cloud-architecture target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/agileitarchitecture target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.tooltips", "navigation.instant", "navigation.tabs.sticky", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.1e8ae164.min.js></script> </body> </html>